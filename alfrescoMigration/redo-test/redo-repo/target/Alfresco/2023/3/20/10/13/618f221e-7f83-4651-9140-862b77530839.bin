
RNN:
Step-by-Step

Ki Hyun Kim

nlp.with.deep.learning@gmail.com




Recurrentï¿½Neuralï¿½Networks

ğ‘¥! â„!



Recurrentï¿½Neuralï¿½Networksï¿½101

â€¢ ë‹¤ë¥¸í‘œí˜„ë°©ë²•

ğ‘¥! â„! â„! â„" â„# â„$ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$
â„! â„" â„# â„$



Recurrentï¿½Neuralï¿½Networkï¿½101

â€¢ Howï¿½itï¿½works.

â„! â„" â„# â„$ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$
#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%
â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&



Zoomï¿½In:ï¿½Inputï¿½Tensor

Ã—ğ‘›



Zoomï¿½In:ï¿½Hiddenï¿½Tensor

Ã—ğ‘›
ğ‘¦



Multi-layeredï¿½RNN

â„# â„$

ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$

#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%
â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&

â„! â„"



Zoomï¿½In:ï¿½Outputï¿½Tensor

â„# â„$

ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$

#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%
â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&

â„! â„"



Zoomï¿½In:ï¿½Hiddenï¿½Stateï¿½Tensor

â„& = #ğ‘™ğ‘ğ‘¦ğ‘’ğ‘Ÿğ‘ , ğ‘ğ‘ğ‘¡ğ‘â„_ğ‘ ğ‘–ğ‘§ğ‘’, â„ğ‘–ğ‘‘ğ‘‘ğ‘’ğ‘›_ğ‘ ğ‘–ğ‘§ğ‘’
â„#

ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$

#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%
â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&

â„! â„" â„$



Zoomï¿½In:ï¿½Inputï¿½Tensor

â„# â„$

ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$

#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%
â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&

â„! â„"
Sameï¿½shapeï¿½asï¿½before



Bidirectionalï¿½Multi-layeredï¿½RNN

ğ‘¥! ğ‘¥" ğ‘¥# ğ‘¥$

#ğ‘¦! #ğ‘¦" #ğ‘¦# #ğ‘¦$
ğ‘¦! ğ‘¦" ğ‘¦# ğ‘¦$

â„%

â„’ ğœƒ = (&'!( #ğ‘¦& âˆ’ ğ‘¦&

â„%



Zoomï¿½In:ï¿½Outputï¿½Tensor

â„!:* = ğ‘ğ‘ğ‘¡ğ‘â„_ğ‘ ğ‘–ğ‘§ğ‘’, ğ‘›, â„ğ‘–ğ‘‘ğ‘‘ğ‘’ğ‘›_ğ‘ ğ‘–ğ‘§ğ‘’Ã—#ğ‘‘ğ‘–ğ‘Ÿğ‘’ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ !! !" !# !$

"#! "#" "## "#$
"! "" "# "$

â„%

â„’ & =( "#& âˆ’ "&'&(!
â„%



Zoomï¿½In:ï¿½Hiddenï¿½Stateï¿½Tensor

!! !" !# !$

"#! "#" "## "#$
"! "" "# "$

â„%

â„’ & =( "#& âˆ’ "&'&(!
â„%



Youï¿½canï¿½referï¿½documents,ï¿½anytime.

Input Shape Output Shape



Summary

â€¢ Singleï¿½layerï¿½RNNì—ì„œ hiddenï¿½stateëŠ” ê³§ outputì´ë‹¤.

â€¢ Multi-layeredï¿½RNNì—ì„œ
â€¢ Outputì€ ë§ˆì§€ë§‰ layerì˜ ëª¨ë“  time-stepì˜ hiddenï¿½stateì´ë‹¤.
â€¢ Hiddenï¿½stateëŠ” ë§ˆì§€ë§‰ time-stepì˜ ëª¨ë“  layerì˜ hiddenï¿½stateì´ë‹¤.

â€¢ Bi-directionalï¿½RNNì—ì„œ
â€¢ Outputì€ hiddenï¿½stateê°€ 2ë°°ê°€ëœë‹¤.
â€¢ Hiddenï¿½stateëŠ” layerì˜ ê°¯ìˆ˜ê°€ 2ë°°ê°€ëœë‹¤.


